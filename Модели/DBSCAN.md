DBSCAN (Density-Based Spatial Clustering of Applications with Noise) — плотностной метод кластеризации, который группирует вместе точки, которые тесно расположены друг к другу (точки с большим количеством соседей), помечая как выбросы (шум) точки, которые находятся в областях с низкой плотностью. В отличие от k-средних, DBSCAN способен находить кластеры произвольной формы и не требует предварительного задания их количества.

| Характерика                  | Значение                            |
| :--------------------------- | :---------------------------------- |
| Задача                       | Кластеризация                       |
| Тип обучения                 | Обучение без учителя                |
| Множество целевой переменной | $\{-1, 1, \dots, K\}$ (-1 для шума) |

# Обучение

Пусть есть:

- $\epsilon$ — радиус окрестности для поиска соседей.
- `min_samples` — минимальное количество точек в $\epsilon$-окрестности точки, чтобы считать её ядровой.

В алгоритме все точки делятся на три типа:

- Ядровая (core point) — точка, в $\epsilon$-окрестности которой находится не менее `min_samples` соседей (включая саму точку).
- Пограничная (border point) — точка, у которой в $\epsilon$-окрестности меньше `min_samples` соседей, но она сама является соседом некоторой ядровой точки.
- Шум (noise point) — точка, которая не является ни ядровой, ни пограничной.

Алгоритм:

1. Выбрать произвольную непосещённую точку $p$.
2. Найти всех соседей точки $p$ в радиусе $\epsilon$.
3. Если количество соседей меньше `min_samples`, пометить точку $p$ как шум. Она может быть позже добавлена в какой-либо кластер как пограничная точка.
4. Если количество соседей больше или равно `min_samples`, создать новый кластер. Поместить точку $p$ (это *ядровая точка*) и всех её соседей в этот кластер.
5. Для каждой *новой* точки в кластере, если она тоже является ядровой, рекурсивно добавить её соседей в этот же кластер. Этот процесс продолжается, пока кластер может расширяться.
6. Повторять шаги 1-5, пока все точки в наборе данных не будут посещены.

## Гиперпараметры

Подход к обучению:

* Радиус окрестности ($\epsilon$): определяет, насколько близко должны находиться точки, чтобы считаться соседями.
* Минимальное количество точек (`min_samples`): определяет минимальную плотность для формирования кластера.
* Метрика расстояния (например, евклидова, манхэттенская) для определения окрестности.

# Предсказание

DBSCAN как таковой не строит предсказательную модель. Чтобы классифицировать новый объект $\mathbf{x}_{\text{new}}$, нужно найти его соседей в радиусе $\epsilon$ среди *уже существующих* данных.

1. Если среди соседей $\mathbf{x}_{\text{new}}$ есть хотя бы одна *ядровая* точка из кластера $C_k$, то $\mathbf{x}_{\text{new}}$ относится к этому же кластеру $C_k$. Если ядровые точки из разных кластеров являются соседями (редкий случай на границе), объект можно отнести к ближайшему или пометить как шум.
2. Если среди соседей нет ни одной ядровой точки, $\mathbf{x}_{\text{new}}$ помечается как шум.

# Оценка качества

* [[Метрики качества кластеризации]]