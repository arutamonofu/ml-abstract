K-средних (k-means) — итеративный метод кластеризации, который разделяет множество объектов на $K$ заранее определённых непересекающихся кластеров, при этом каждый объект принадлежит кластеру с ближайшим центром (центроидом), а целью является минимизация суммарного квадратичного расстояния от точек до центроидов их кластеров.

| Характеристика               | Значение             |
| :--------------------------- | :------------------- |
| Задача                       | Кластеризация        |
| Тип обучения                 | Обучение без учителя |
| Множество целевой переменной | $\{1, \dots, K\}$    |

# Обучение

Пусть есть:

- $K$ — количество кластеров
- Множество центроидов $\boldsymbol{\mu}_k$, $k \in \{1, \dots, K\}$

Алгоритм:

1. Инициализировать $K$ центроидов $\boldsymbol{\mu}_1, \dots, \boldsymbol{\mu}_K$, например, выбрав $K$ случайных объектов из набора данных.
2. Для каждого объекта вычислить расстояние до каждого центроида и отнести объект к кластеру с ближайшим центроидом.
3. Для каждого кластера пересчитать положение его центроида как среднее арифметическое всех объектов, входящих в этот кластер.
4. Повторять шаги 2–3 до выполнения одного из условий остановки.

## Гиперпараметры

Подход к обучению:

* Количество кластеров ($K$);
* Метод инициализации центроидов (например, k-means++ для более стабильных результатов или случайный);
* Количество запусков алгоритма с разными начальными центроидами (выбирается лучший результат по инерции).

Условия остановки:

* Максимальное количество итераций обучения;
* Минимальное изменение положения центроидов для продолжения обучения (допуск).

## Функция потерь

| Название                                   | Описание                                                                                                              | Обозначение    | Формула                                                                            |
| ------------------------------------------ | --------------------------------------------------------------------------------------------------------------------- | -------------- | ---------------------------------------------------------------------------------- |
| Сумма квадратов расстояний внутри кластера | Сумма квадратов евклидовых расстояний от каждого объекта до центроида его кластера. Чем меньше, тем плотнее кластеры. | WCSS (Inertia) | $\sum_{k=1}^{K} \sum_{\mathbf{x}_i \in C_k} (\mathbf{x}_i - \boldsymbol{\mu}_k)^2$ |

# Предсказание

Для нового объекта $\mathbf{x}_{\text{new}}$ вычисляется расстояние до каждого из $K$ обученных центроидов. Объект относится к тому кластеру, центроид которого находится ближе всего:

$$\text{кластер}(\mathbf{x}_{\text{new}}) = \underset{k \in \{1, \dots, K\}}{\operatorname{argmin}} (\mathbf{x}_{\text{new}} - \boldsymbol{\mu}_k)^2$$

# Оценка качества

*   [[Метрики качества кластеризации]]